"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[131],{1131:(e,a,s)=>{s.r(a),s.d(a,{default:()=>j});var t=s(5043),r=s(2018),l=(s(3760),s(9722)),n=s(9379),i=s(1045),d=s(828),c=s(1104),o=s(5797),u=s(5758),g=s(970),m=s(579);const p=e=>{const[a,s]=(0,t.useState)(null),l=["first grade","second grade","third grade","fourth grade","fifth grade","sixth grade","seventh grade","eighth grade","ninth grade","tenth grade","eleventh grade","twelfth grade"],[n,i]=(0,t.useState)(null),{updateGrade:c,visible:p,setVisible:h,grade:x}=e,f=((0,t.useRef)(""),(0,t.useRef)(""),(0,t.useRef)(null));(0,t.useEffect)((()=>{x&&s(x.name)}),[x]);return(0,m.jsxs)(o.l,{visible:p,modal:!0,header:"Update Grade",style:{width:"400px",borderRadius:"8px"},onHide:()=>h(!1),onClick:e=>e.stopPropagation(),children:[(0,m.jsx)(d.y,{ref:f}),(0,m.jsx)(g.r,{}),(0,m.jsxs)("div",{className:"flex flex-column gap-4",style:{padding:"1rem"},children:[(0,m.jsxs)("div",{className:"flex flex-column gap-2",children:[(0,m.jsx)("label",{htmlFor:"name",className:"font-medium",children:"Name"}),(0,m.jsx)(u.j,{id:"name",value:a,suggestions:n,completeMethod:e=>{i(l)},dropdown:!0,onChange:e=>s(e.value),placeholder:"Select grade",className:"p-inputtext-sm"})]}),(0,m.jsxs)("div",{className:"flex justify-content-center gap-2",children:[(0,m.jsx)(r.$,{label:"Update",onClick:e=>{e.stopPropagation(),c(a),h(!1)},className:"p-button p-button-primary"}),(0,m.jsx)(r.$,{label:"Cancel",onClick:e=>{e.stopPropagation(),h(!1)},className:"p-button p-button-secondary"})]})]})]})};var h=s(3003),x=s(3488);const f=e=>{const[a,s]=(0,t.useState)(!1),o=(0,t.useRef)(null),u=(0,t.useRef)(null),{token:f}=(0,h.d4)((e=>e.token)),{user:v}=(0,h.d4)((e=>e.token)),y=(0,i.Zp)(),j=(0,x.z)().API_URL,[b,N]=(0,t.useState)(!1),[w,C]=(0,t.useState)(null),[k,G]=(0,t.useState)(!1),A=(0,m.jsxs)("div",{className:"card flex flex-wrap gap-2 justify-content-center",children:["Admin"===(null===v||void 0===v?void 0:v.roles)&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(r.$,{icon:"pi pi-times",label:"Delete",onClick:a=>{a.stopPropagation(),(0,g.P)({target:a.currentTarget,message:"Are you sure you want to delete the grade and all the files in it?",icon:"pi pi-exclamation-triangle",defaultFocus:"accept",accept:()=>{a.stopPropagation(),(async s=>{try{const a=await l.A.delete("".concat(j,"api/grade/").concat(s),{headers:{Authorization:"Bearer ".concat(f)}});Array.isArray(a.data)&&(e.setGradesData(a.data),o.current&&o.current.show({severity:"success",summary:"Deleted successfuly",life:3e3}))}catch(a){var t,r;o.current.show({severity:"error",summary:"Error deleting",detail:(null===(t=a.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.message)||a.message,life:4e3})}finally{N(!1)}})(e.grade._id),s(!1)},reject:()=>{a.stopPropagation(),s(!1)}})}}),(0,m.jsx)(r.$,{label:"Update",icon:"pi pi-pencil",onClick:e=>{e.stopPropagation(),s(!0)}})]}),(0,m.jsx)(p,{updateGrade:async(a,s)=>{const t=(0,n.A)((0,n.A)({},e.grade),{},{name:a});try{const a=await l.A.put("".concat(j,"api/grade"),t,{headers:{Authorization:"Bearer ".concat(f)}});200===a.status&&(e.setGradesData(a.data),null!==o&&void 0!==o&&o.current&&o.current.show({severity:"success",summary:"Updated successfully",life:3e3}))}catch(r){409===r.status&&null!==o&&void 0!==o&&o.current&&o.current.show({severity:"error",summary:"This grade alredy exits",life:4e3}),400===r.status&&null!==o&&void 0!==o&&o.current&&o.current.show({severity:"error",summary:"Grade name is required",life:4e3}),console.error(r)}},setVisible:s,visible:a,grade:e.grade})]});return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.y,{ref:o}),(0,m.jsx)(c.T,{}),(0,m.jsx)(d.y,{ref:u}),(0,m.jsx)(g.r,{}),(0,m.jsx)("div",{className:"col-12 sm:col-6 lg:col-12 xl:col-4 p-2",children:(0,m.jsxs)("div",{className:"p-4 border-1 surface-border surface-card border-round",onClick:a=>{a.stopPropagation(),y("/books/".concat(e.grade._id))},style:{cursor:"pointer"},children:[(0,m.jsxs)("div",{className:"flex flex-column align-items-center gap-3 py-5",children:[(0,m.jsx)("img",{className:"course-image",src:"/pictures/".concat(e.grade.name,".png"),alt:e.grade.name}),(0,m.jsx)("div",{className:"text-2xl font-bold",children:e.grade.name})]}),A]})},e.grade._id)]})},v=e=>{const[a,s]=(0,t.useState)(null),l=["first grade","second grade","third grade","fourth grade","fifth grade","sixth grade","seventh grade","eighth grade","ninth grade","tenth grade","eleventh grade","twelfth grade"],[n,i]=(0,t.useState)(null),{createGrade:d,visibleCreatGrade:c}=e,g=(0,t.useRef)("");return(0,m.jsx)(o.l,{visible:c,modal:!0,onHide:()=>e.setVisibleCreatGrade(!1),style:{width:"25rem",borderRadius:"8px"},className:"custom-dialog",children:(0,m.jsxs)("div",{className:"flex flex-column gap-4 p-4",children:[(0,m.jsxs)("div",{className:"flex flex-column gap-2",children:[(0,m.jsx)("label",{className:"text-gray-700 font-medium",children:"Name"}),(0,m.jsx)(u.j,{value:a,suggestions:n,completeMethod:e=>{i(l)},virtualScrollerOptions:{itemSize:38},dropdown:!0,onChange:e=>s(e.value),className:"p-inputtext p-3 border border-gray-300 rounded-md w-full"})]}),(0,m.jsxs)("div",{className:"flex justify-content-between gap-3",children:[(0,m.jsx)(r.$,{label:"Create",onClick:s=>{d(a,g),e.setVisibleCreatGrade(!1)},className:"bg-indigo-500 text-white px-5 py-2 rounded-md hover:bg-indigo-600"}),(0,m.jsx)(r.$,{label:"Cancel",onClick:()=>e.setVisibleCreatGrade(!1),className:"bg-gray-500 text-white px-5 py-2 rounded-md hover:bg-gray-600"})]})]})})};var y=s(65);s(9906);const j=()=>{const{token:e}=(0,h.d4)((e=>e.token)),{user:a}=(0,h.d4)((e=>e.token)),[s,n]=(0,t.useState)([]),[i,c]=(0,t.useState)(!1),o=(0,t.useRef)(null),u=(0,x.z)().API_URL,[g,p]=(0,t.useState)(!1),j=async()=>{try{const e=await l.A.get("".concat(u,"api/grade"));200===e.status&&n(e.data)}catch(e){console.error(e)}};(0,t.useEffect)((()=>{(async()=>{p(!0);try{j()}finally{p(!1)}})()}),[]);return(0,m.jsx)(m.Fragment,{children:g?(0,m.jsx)("div",{className:"flex justify-content-center align-items-center",style:{height:"80vh"},children:(0,m.jsxs)("div",{className:"flex justify-center items-center gap-3 text-xl mt-6",children:[(0,m.jsx)("div",{className:"custom-spinner"}),(0,m.jsx)("span",{children:"Loading, please wait..."})]})}):(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(d.y,{ref:o}),"Admin"===(null===a||void 0===a?void 0:a.roles)&&(0,m.jsx)(r.$,{icon:"pi pi-plus",rounded:!0,"aria-label":"Filter",onClick:()=>c(!0),className:"add-button"}),(0,m.jsx)(v,{createGrade:async(a,s)=>{const t={name:a,image:s.current.value?s.current.value:" "};try{201===(await l.A.post("".concat(u,"api/grade"),t,{headers:{Authorization:"Bearer ".concat(e)}})).status&&j()}catch(r){409===r.status&&null!==o&&void 0!==o&&o.current&&o.current.show({severity:"error",summary:"This grade alredy exits",life:4e3}),400===r.status&&null!==o&&void 0!==o&&o.current&&o.current.show({severity:"error",summary:"Grade name is required",life:4e3}),console.error(r)}},setVisibleCreatGrade:c,visibleCreatGrade:i}),(0,m.jsx)("div",{className:"card",children:(0,m.jsx)(y.U$,{value:s,listTemplate:e=>(0,m.jsx)("div",{className:"grid grid-nogutter",children:e.map(((e,a)=>(e=>{if(e)return(0,m.jsx)(f,{grade:e,getGrades:j,setGradesData:n})})(e)))})})})]})})}},9906:()=>{}}]);
//# sourceMappingURL=131.2f5ec741.chunk.js.map